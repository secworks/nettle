//======================================================================
//
// umactest.c
// ----------
// Program that tests the functionality of the UMAC authentication
// function and perform benchmarking.
//
//
// Author: Joachim Strombergson
// (c) 2014, Secworks Sweden AB
// All rights reserved.
//
//======================================================================

//------------------------------------------------------------------
// Includes.
//------------------------------------------------------------------
#include <stdio.h>
#include <stdint.h>
#include <umac.h>


int main(void)
{
  struct umac128_ctx my_ctx;
  // 256 bit key.
  uint8_t my_key[] = {0x01, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
                      0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,
                      0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
                      0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f};

  // 64 bit nonce.
  uint8_t my_nonce[] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

  
  // 1024 byte data.
  uint8_t my_data[] = {0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,                       
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67,
                       0xde, 0xad, 0xbe, 0xef, 0x01, 0x23, 0x45, 0x67};

  uint8_t my_digest[16];

  uint32_t i;
  
  printf("Test of umac in nettle.\n");
    
  umac128_set_key(&my_ctx, &my_key[0]);

  for (i = 0 ; i < 100000000 ; i++)
    {
      umac128_set_nonce (&my_ctx, 8, &my_nonce[0]);
      umac128_update (&my_ctx, 1024, &my_data[0]);
    }
  
  umac128_digest (&my_ctx, 16, &my_digest[0]);

  for (i = 0 ; i < 16 ; i++)
    {                                           \
      printf("digest[%02d] = 0x%02x\n", i, my_digest[i]);
    }
  
  return 0;
}


//======================================================================
// EOF umactest.c
//======================================================================
